{"version":3,"file":"charts.min.js","sources":["../../../src/local/grading2/charts.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * TODO describe module charts\n *\n * @module     mod_competvet/local/grading2/charts\n * @copyright  2024 Bas Brands <bas@sonsbeekmedia.nl>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport ChartJS from 'core/chartjs';\n\nconst chartJSON = {\n    \"criteria\": [\n        {\n            \"id\": 1,\n            \"name\": \"Compétences liées à la démarche clinique\",\n            \"grades\": [\n                {\n                    \"id\": 1,\n                    \"userid\": 1,\n                    \"gradername\": \"Sylvain Bellier\",\n                    \"value\": 90\n                },\n                {\n                    \"id\": 2,\n                    \"userid\": 2,\n                    \"gradername\": \"Camille Moulin\",\n                    \"value\": 85\n                },\n                {\n                    \"id\": 3,\n                    \"userid\": 3,\n                    \"gradername\": \"Pierre Deshuillers\",\n                    \"value\": 95\n                },\n                {\n                    \"id\": 4,\n                    \"userid\": 4,\n                    \"gradername\": \"Marine Le-Dudal\",\n                    \"value\": 92\n                }\n            ]\n        },\n        {\n            \"id\": 2,\n            \"name\": \"Compétences techniques et activités de soins\",\n            \"grades\": [\n                {\n                    \"id\": 1,\n                    \"userid\": 1,\n                    \"gradername\": \"Sylvain Bellier\",\n                    \"value\": 80\n                },\n                {\n                    \"id\": 2,\n                    \"userid\": 2,\n                    \"gradername\": \"Camille Moulin\",\n                    \"value\": 75\n                },\n                {\n                    \"id\": 3,\n                    \"userid\": 3,\n                    \"gradername\": \"Pierre Deshuillers\",\n                    \"value\": 85\n                },\n                {\n                    \"id\": 4,\n                    \"userid\": 4,\n                    \"gradername\": \"Marine Le-Dudal\",\n                    \"value\": 82\n                }\n            ]\n        },\n        {\n            \"id\": 3,\n            \"name\": \"Compétences liées à la mobilisation des acquis\",\n            \"grades\": [\n                {\n                    \"id\": 1,\n                    \"userid\": 1,\n                    \"gradername\": \"Sylvain Bellier\",\n                    \"value\": 95\n                },\n                {\n                    \"id\": 2,\n                    \"userid\": 2,\n                    \"gradername\": \"Camille Moulin\",\n                    \"value\": 90\n                },\n                {\n                    \"id\": 3,\n                    \"userid\": 3,\n                    \"gradername\": \"Pierre Deshuillers\",\n                    \"value\": 92\n                },\n                {\n                    \"id\": 4,\n                    \"userid\": 4,\n                    \"gradername\": \"Marine Le-Dudal\",\n                    \"value\": 88\n                }\n            ]\n        },\n        {\n            \"id\": 4,\n            \"name\": \"Qualité d’organisation et de travail en équipe\",\n            \"grades\": [\n                {\n                    \"id\": 1,\n                    \"userid\": 1,\n                    \"gradername\": \"Sylvain Bellier\",\n                    \"value\": 88\n                },\n                {\n                    \"id\": 2,\n                    \"userid\": 2,\n                    \"gradername\": \"Camille Moulin\",\n                    \"value\": 90\n                },\n                {\n                    \"id\": 3,\n                    \"userid\": 3,\n                    \"gradername\": \"Pierre Deshuillers\",\n                    \"value\": 85\n                },\n                {\n                    \"id\": 4,\n                    \"userid\": 4,\n                    \"gradername\": \"Marine Le-Dudal\",\n                    \"value\": 92\n                }\n            ]\n        },\n        {\n            \"id\": 5,\n            \"name\": \"Motivation et implication personnelle\",\n            \"grades\": [\n                {\n                    \"id\": 1,\n                    \"userid\": 1,\n                    \"gradername\": \"Sylvain Bellier\",\n                    \"value\": 92\n                },\n                {\n                    \"id\": 2,\n                    \"userid\": 2,\n                    \"gradername\": \"Camille Moulin\",\n                    \"value\": 88\n                },\n                {\n                    \"id\": 3,\n                    \"userid\": 3,\n                    \"gradername\": \"Pierre Deshuillers\",\n                    \"value\": 90\n                },\n                {\n                    \"id\": 4,\n                    \"userid\": 4,\n                    \"gradername\": \"Marine Le-Dudal\",\n                    \"value\": 95\n                }\n            ]\n        }\n    ]\n};\n\nclass CompetCharts {\n    /**\n    * Constructor.\n    */\n    constructor() {\n        this.charts = [];\n    }\n\n    /**\n     * Create a chart.\n     * @param {String} id The id.\n     * @param {Object} data The data.\n     */\n    createChart(id, data) {\n        const ctx = document.getElementById(id);\n        if (ctx.dataset.used) {\n            return;\n        }\n        ctx.dataset.used = true;\n        const chart = new ChartJS(ctx, data);\n        this.charts.push(chart);\n    }\n\n    /**\n     * Chart data colors.\n     * @return {Array} The colors.\n     */\n    colors() {\n        return [\n            'rgba(0, 178, 254, 1)',\n            'rgba(105, 52, 219, 1)',\n            'rgba(14, 204, 135, 1)',\n            'rgba(254, 229, 0, 1)'\n        ];\n    }\n\n    transformData(originalData) {\n        const labels = originalData.eval.map(criterion => criterion.name);\n        const graders = {};\n        const colors = this.colors();\n\n        originalData.eval.forEach(criterion => {\n            criterion.grades.forEach(grade => {\n                if (!graders[grade.userid]) {\n                    const color = colors.shift();\n                    graders[grade.userid] = {\n                        label: grade.gradername,\n                        data: [],\n                        fill: false,\n                        backgroundColor: color,\n                        // add other properties as needed\n                    };\n                }\n\n                graders[grade.userid].data.push(grade.value);\n            });\n        });\n\n        return {\n            labels,\n            datasets: Object.values(graders),\n        };\n    }\n\n    /**\n     * Create the first ChartJS chart, it uses the chartJSON. The chart is a radar chart. The title is rendered directly underneath\n     * the chart \"Evaluations des observateurs\".\n     * Each criteria is an axis and the grades are the values. The grade values are color coded to match the grader shown in the\n     * legend. Grades by \"Camille Moulin\" are excluded from the chart.\n     * The mean grade value is calculated and drawn as a shape area on top of the chart.\n     * @param {Object} chartData The chart data.\n     */\n    evaluationChart(chartData) {\n        const transFormed = this.transformData(chartData);\n        const data = {\n            type: 'radar',\n            data: {\n                labels: transFormed.labels,\n                datasets: transFormed.datasets,\n            },\n            options: {\n\n                title: {\n                    display: true,\n                    text: 'Evaluations des observateurs',\n                    position: 'bottom',\n                    fontSize: 16,\n                },\n                scale: {\n                    ticks: {\n                        display: false,\n                    }\n                },\n                plugins: {\n                    title: {\n                        display: true,\n                        text: 'Evaluations des observateurs',\n                        position: 'bottom',\n                    },\n                    legend: {\n                        display: true,\n                        position: 'bottom' // Moves the legend below the chart\n                    },\n                }\n            }\n        };\n        this.createChart('evaluationChart', data);\n    }\n\n    /**\n     * Create the second ChartJS chart, it uses the chartJSON. The chart is a radar chart. It only shows the grades of Camille\n     * Moulin. The title is rendered directly underneath the chart \"Evaluations de Camille Moulin\".\n     */\n    selfEvaluationChart() {\n        const transFormed = this.transformData(chartJSON);\n        const data = {\n            type: 'radar',\n            data: {\n                labels: transFormed.labels,\n                datasets: [transFormed.datasets[1]],\n            },\n            options: {\n                title: {\n                    display: true,\n                    text: 'Evaluations de Camille Moulin',\n                    position: 'bottom',\n                    fontSize: 16,\n                },\n                scale: {\n                    ticks: {\n                        display: false,\n                    }\n                },\n                plugins: {\n                    title: {\n                        display: true,\n                        text: 'Evaluations de Camille Moulin',\n                        position: 'bottom',\n                    },\n                    legend: {\n                        display: false,\n                    },\n                }\n            }\n        };\n        this.createChart('selfEvaluationChart', data);\n    }\n}\n\nconst charts = new CompetCharts();\n\nexport default charts;\n"],"names":["chartJSON","constructor","charts","createChart","id","data","ctx","document","getElementById","dataset","used","chart","ChartJS","push","colors","transformData","originalData","labels","eval","map","criterion","name","graders","this","forEach","grades","grade","userid","color","shift","label","gradername","fill","backgroundColor","value","datasets","Object","values","evaluationChart","chartData","transFormed","type","options","title","display","text","position","fontSize","scale","ticks","plugins","legend","selfEvaluationChart"],"mappings":";;;;;;;qJAwBMA,UAAY,UACF,CACR,IACU,OACE,kDACE,CACN,IACU,SACI,aACI,wBACL,IAEb,IACU,SACI,aACI,uBACL,IAEb,IACU,SACI,aACI,2BACL,IAEb,IACU,SACI,aACI,wBACL,MAIrB,IACU,OACE,sDACE,CACN,IACU,SACI,aACI,wBACL,IAEb,IACU,SACI,aACI,uBACL,IAEb,IACU,SACI,aACI,2BACL,IAEb,IACU,SACI,aACI,wBACL,MAIrB,IACU,OACE,wDACE,CACN,IACU,SACI,aACI,wBACL,IAEb,IACU,SACI,aACI,uBACL,IAEb,IACU,SACI,aACI,2BACL,IAEb,IACU,SACI,aACI,wBACL,MAIrB,IACU,OACE,wDACE,CACN,IACU,SACI,aACI,wBACL,IAEb,IACU,SACI,aACI,uBACL,IAEb,IACU,SACI,aACI,2BACL,IAEb,IACU,SACI,aACI,wBACL,MAIrB,IACU,OACE,+CACE,CACN,IACU,SACI,aACI,wBACL,IAEb,IACU,SACI,aACI,uBACL,IAEb,IACU,SACI,aACI,2BACL,IAEb,IACU,SACI,aACI,wBACL,qBA4Jd,UAjJXC,mBACSC,OAAS,GAQlBC,YAAYC,GAAIC,YACNC,IAAMC,SAASC,eAAeJ,OAChCE,IAAIG,QAAQC,YAGhBJ,IAAIG,QAAQC,MAAO,QACbC,MAAQ,IAAIC,iBAAQN,IAAKD,WAC1BH,OAAOW,KAAKF,OAOrBG,eACW,CACH,uBACA,wBACA,wBACA,wBAIRC,cAAcC,oBACJC,OAASD,aAAaE,KAAKC,KAAIC,WAAaA,UAAUC,OACtDC,QAAU,GACVR,OAASS,KAAKT,gBAEpBE,aAAaE,KAAKM,SAAQJ,YACtBA,UAAUK,OAAOD,SAAQE,YAChBJ,QAAQI,MAAMC,QAAS,OAClBC,MAAQd,OAAOe,QACrBP,QAAQI,MAAMC,QAAU,CACpBG,MAAOJ,MAAMK,WACb1B,KAAM,GACN2B,MAAM,EACNC,gBAAiBL,OAKzBN,QAAQI,MAAMC,QAAQtB,KAAKQ,KAAKa,MAAMQ,aAIvC,CACHjB,OAAAA,OACAkB,SAAUC,OAAOC,OAAOf,UAYhCgB,gBAAgBC,iBACNC,YAAcjB,KAAKR,cAAcwB,WACjClC,KAAO,CACToC,KAAM,QACNpC,KAAM,CACFY,OAAQuB,YAAYvB,OACpBkB,SAAUK,YAAYL,UAE1BO,QAAS,CAELC,MAAO,CACHC,SAAS,EACTC,KAAM,+BACNC,SAAU,SACVC,SAAU,IAEdC,MAAO,CACHC,MAAO,CACHL,SAAS,IAGjBM,QAAS,CACLP,MAAO,CACHC,SAAS,EACTC,KAAM,+BACNC,SAAU,UAEdK,OAAQ,CACJP,SAAS,EACTE,SAAU,kBAKrB3C,YAAY,kBAAmBE,MAOxC+C,4BACUZ,YAAcjB,KAAKR,cAAcf,WACjCK,KAAO,CACToC,KAAM,QACNpC,KAAM,CACFY,OAAQuB,YAAYvB,OACpBkB,SAAU,CAACK,YAAYL,SAAS,KAEpCO,QAAS,CACLC,MAAO,CACHC,SAAS,EACTC,KAAM,gCACNC,SAAU,SACVC,SAAU,IAEdC,MAAO,CACHC,MAAO,CACHL,SAAS,IAGjBM,QAAS,CACLP,MAAO,CACHC,SAAS,EACTC,KAAM,gCACNC,SAAU,UAEdK,OAAQ,CACJP,SAAS,WAKpBzC,YAAY,sBAAuBE"}