define("mod_competvet/local/user_selector_reactive",["exports","core/reactive","core/ajax","core/notification","mod_competvet/local/events","mod_competvet/local/user_selector_mutations"],(function(_exports,_reactive,_ajax,_notification,_events,_user_selector_mutations){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Main course editor module.
   *
   * All formats can register new components on this object to create new reactive
   * UI components that watch the current course state.
   *
   * @module     mod_competvet/local/user_list
   * @class     mod_competvet/local/userList
   * @copyright  2023 Laurent David <laurent@call-learning.fr>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.dispatchStateChangedEvent=_exports.UserSelectorReactive=void 0,_ajax=_interopRequireDefault(_ajax),_notification=_interopRequireDefault(_notification),_events=_interopRequireDefault(_events);class UserSelectorReactive extends _reactive.Reactive{async loadUsers(cmId,roleArchetype){this.cmId=cmId;try{const{users:userList}=await _ajax.default.call([{methodname:"mod_competvet_get_user_list",args:{cmid:this.cmId,roletype:roleArchetype}}])[0];let currentUser=_user_selector_mutations.UserSelectorMutations.getCurrentUser(this.cmId);currentUser&&userList.find((user=>user.id===currentUser))||(currentUser=0,userList.length>0&&(currentUser=userList[0].id,_user_selector_mutations.UserSelectorMutations.setCurrentUser(currentUser,this.cmId)));const initialState={info:{currentUser:currentUser,cmId:this.cmId,filterShow:!1},users:userList};return this.setInitialState(initialState),!0}catch(error){return await _notification.default.exception(error),!1}}}_exports.UserSelectorReactive=UserSelectorReactive;_exports.dispatchStateChangedEvent=(detail,target)=>{void 0===target&&(target=document),target.dispatchEvent(new CustomEvent(_events.default.userSelectorChanged,{bubbles:!0,detail:detail}))}}));

//# sourceMappingURL=user_selector_reactive.min.js.map