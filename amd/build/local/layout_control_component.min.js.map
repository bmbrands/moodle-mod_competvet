{"version":3,"file":"layout_control_component.min.js","sources":["../../src/local/layout_control_component.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Layout control component.\n *\n * @module     mod_competvet/local/layout_control_component\n * @copyright  2023 Laurent David <laurent@call-learning.fr>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport {BaseComponent} from 'core/reactive';\nimport {getGradingAppReactive} from 'mod_competvet/local/grading_app_reactive';\n\nexport default class extends BaseComponent {\n    /**\n     * Constructor hook.\n     */\n    create() {\n        // Optional component name for debugging.\n        this.name = 'user-selector';\n        this.selectors = {\n            LAYOUT_COLLAPSE_REVIEW: `button.collapse-review-panel`,\n            LAYOUT_COLLAPSE_GRADING: `button.collapse-grade-panel`,\n            LAYOUT_DEFAULT: `button.collapse-none`,\n            REVIEW_PANEL: `[data-region='review-panel']`,\n            GRADING_PANEL: `[data-region='grade-panel']`,\n        };\n    }\n\n    /**\n     * Static method to create a component instance form the mustache template.\n     *\n     * @param {Node} element the DOM main element\n     * @param {object} selectors optional css selector overrides\n     * @return {BaseComponent} the component instance\n     */\n    static init(element, selectors) {\n        const cmId = element.dataset.cmid;\n        const reactive = getGradingAppReactive(cmId); // Get or create reactive.\n        return new this({\n            element: element,\n            reactive: reactive,\n            selectors,\n        });\n    }\n\n    /**\n     * Initial state ready method.\n     *\n     * @return {Promise<void>}\n     */\n    async stateReady() {\n        // Get the element to replace.\n        const target = this.getElement();\n        this.addEventListener(\n            target.querySelector(this.selectors.LAYOUT_COLLAPSE_REVIEW),\n            'click',\n            this._collapseReviewPanel\n        );\n        this.addEventListener(\n            target.querySelector(this.selectors.LAYOUT_COLLAPSE_GRADING),\n            'click',\n            this._collapseGradingPanel,\n        );\n        this.addEventListener(\n            target.querySelector(this.selectors.LAYOUT_DEFAULT),\n            'click',\n            this._setDefaultLayout,\n        );\n    }\n\n    /**\n     * Collapse review panel.\n     *\n     * @param {Event} event\n     */\n    _collapseReviewPanel(event) {\n        event.preventDefault();\n        const gradingPanel = this.getElement().parentNode.parentNode.parentNode;\n        gradingPanel.querySelector(this.selectors.REVIEW_PANEL).classList.add('collapsed');\n        gradingPanel.querySelector(this.selectors.REVIEW_PANEL).classList.remove('expanded');\n        gradingPanel.querySelector(this.selectors.GRADING_PANEL).classList.add('expanded');\n        gradingPanel.querySelector(this.selectors.GRADING_PANEL).classList.remove('collapsed');\n    }\n\n\n    /**\n     * Collapse grading panel.\n     *\n     * @param {Event} event\n     */\n    _collapseGradingPanel(event) {\n        event.preventDefault();\n        const gradingPanel = this.getElement().parentNode.parentNode.parentNode;\n        gradingPanel.querySelector(this.selectors.GRADING_PANEL).classList.remove('expanded');\n        gradingPanel.querySelector(this.selectors.GRADING_PANEL).classList.add('collapsed');\n        gradingPanel.querySelector(this.selectors.REVIEW_PANEL).classList.add('expanded');\n        gradingPanel.querySelector(this.selectors.REVIEW_PANEL).classList.remove('collapsed');\n    }\n\n    /**\n     * Back to default layout.\n     *\n     * @param {Event} event\n     */\n    _setDefaultLayout(event) {\n        event.preventDefault();\n        const gradingPanel = this.getElement().parentNode.parentNode.parentNode;\n        gradingPanel.querySelector(this.selectors.REVIEW_PANEL).classList.remove('collapsed');\n        gradingPanel.querySelector(this.selectors.GRADING_PANEL).classList.remove('collapsed');\n        gradingPanel.querySelector(this.selectors.REVIEW_PANEL).classList.remove('expanded');\n        gradingPanel.querySelector(this.selectors.GRADING_PANEL).classList.remove('expanded');\n    }\n}\n"],"names":["BaseComponent","create","name","selectors","LAYOUT_COLLAPSE_REVIEW","LAYOUT_COLLAPSE_GRADING","LAYOUT_DEFAULT","REVIEW_PANEL","GRADING_PANEL","element","cmId","dataset","cmid","this","reactive","target","getElement","addEventListener","querySelector","_collapseReviewPanel","_collapseGradingPanel","_setDefaultLayout","event","preventDefault","gradingPanel","parentNode","classList","add","remove"],"mappings":";;;;;;;;uBA0B6BA,wBAIzBC,cAESC,KAAO,qBACPC,UAAY,CACbC,sDACAC,sDACAC,sCACAC,4CACAC,yDAWIC,QAASN,iBACXO,KAAOD,QAAQE,QAAQC,YAEtB,IAAIC,KAAK,CACZJ,QAASA,QACTK,UAHa,+CAAsBJ,MAInCP,UAAAA,qCAWEY,OAASF,KAAKG,kBACfC,iBACDF,OAAOG,cAAcL,KAAKV,UAAUC,wBACpC,QACAS,KAAKM,2BAEJF,iBACDF,OAAOG,cAAcL,KAAKV,UAAUE,yBACpC,QACAQ,KAAKO,4BAEJH,iBACDF,OAAOG,cAAcL,KAAKV,UAAUG,gBACpC,QACAO,KAAKQ,mBASbF,qBAAqBG,OACjBA,MAAMC,uBACAC,aAAeX,KAAKG,aAAaS,WAAWA,WAAWA,WAC7DD,aAAaN,cAAcL,KAAKV,UAAUI,cAAcmB,UAAUC,IAAI,aACtEH,aAAaN,cAAcL,KAAKV,UAAUI,cAAcmB,UAAUE,OAAO,YACzEJ,aAAaN,cAAcL,KAAKV,UAAUK,eAAekB,UAAUC,IAAI,YACvEH,aAAaN,cAAcL,KAAKV,UAAUK,eAAekB,UAAUE,OAAO,aAS9ER,sBAAsBE,OAClBA,MAAMC,uBACAC,aAAeX,KAAKG,aAAaS,WAAWA,WAAWA,WAC7DD,aAAaN,cAAcL,KAAKV,UAAUK,eAAekB,UAAUE,OAAO,YAC1EJ,aAAaN,cAAcL,KAAKV,UAAUK,eAAekB,UAAUC,IAAI,aACvEH,aAAaN,cAAcL,KAAKV,UAAUI,cAAcmB,UAAUC,IAAI,YACtEH,aAAaN,cAAcL,KAAKV,UAAUI,cAAcmB,UAAUE,OAAO,aAQ7EP,kBAAkBC,OACdA,MAAMC,uBACAC,aAAeX,KAAKG,aAAaS,WAAWA,WAAWA,WAC7DD,aAAaN,cAAcL,KAAKV,UAAUI,cAAcmB,UAAUE,OAAO,aACzEJ,aAAaN,cAAcL,KAAKV,UAAUK,eAAekB,UAAUE,OAAO,aAC1EJ,aAAaN,cAAcL,KAAKV,UAAUI,cAAcmB,UAAUE,OAAO,YACzEJ,aAAaN,cAAcL,KAAKV,UAAUK,eAAekB,UAAUE,OAAO"}