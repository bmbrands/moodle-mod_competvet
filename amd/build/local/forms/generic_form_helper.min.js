define("mod_competvet/local/forms/generic_form_helper",["exports","core_form/modalform","core/str","core/notification"],(function(_exports,_modalform,_str,_notification){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Javascript adding a new observation.
   *
   * @module     mod_competvet/local/forms/observation_add_form
   * @copyright  2023 Laurent David <laurent@call-learning.fr>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.getSelectedElement=_exports.genericForm=void 0,_modalform=_interopRequireDefault(_modalform),_notification=_interopRequireDefault(_notification);const defaultSubmitEventHandler=event=>{event.detail.returnurl?(window.location.assign(event.detail.returnurl),window.location.reload()):_notification.default.addNotification({type:"error",message:event.detail.error})};_exports.genericForm=async(action,modulename,submitEventHandler)=>{const selectedElements=getSelectedElement(action);selectedElements&&(void 0===typeof submitEventHandler&&(submitEventHandler=defaultSubmitEventHandler),selectedElements.forEach((element=>{element.addEventListener("click",(event=>{event.preventDefault();const dataset=event.target.closest("[data-action]").dataset,datasetLowercase=Object.entries(dataset).reduce(((acc,_ref)=>{let[key,value]=_ref;return acc[key.toLowerCase()]=value,acc}),{}),modalForm=new _modalform.default({modalConfig:{title:(0,_str.get_string)("observation:".concat(action),modulename)},formClass:"".concat(modulename,"\\form\\eval_observation_").concat(action),args:{...datasetLowercase,currenturl:window.location.href},saveButtonText:(0,_str.get_string)("observation:".concat(action,":save"),modulename)});modalForm.addEventListener(modalForm.events.FORM_SUBMITTED,submitEventHandler),modalForm.show()}))})))};const getSelectedElement=actionName=>document.querySelectorAll('[data-action="eval-observation-'.concat(actionName,'"]'));_exports.getSelectedElement=getSelectedElement}));

//# sourceMappingURL=generic_form_helper.min.js.map