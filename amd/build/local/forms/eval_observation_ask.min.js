define("mod_competvet/local/forms/eval_observation_ask",["exports","core/str","core/notification","core/modal_factory","core/ajax","core/templates","./generic_form_helper"],(function(_exports,_str,_notification,_modal_factory,_ajax,_templates,_generic_form_helper){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Javascript adding a new observation.
   *
   * @module     mod_competvet/local/forms/observation_add_form
   * @copyright  2023 Laurent David <laurent@call-learning.fr>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.initUsersAction=_exports.init=void 0,_notification=_interopRequireDefault(_notification),_modal_factory=_interopRequireDefault(_modal_factory),_ajax=_interopRequireDefault(_ajax),_templates=_interopRequireDefault(_templates);_exports.init=modulename=>{(0,_generic_form_helper.genericForm)("ask",modulename,(event=>{(0,_str.get_string)("observation:ask",modulename).then((title=>{_modal_factory.default.create({title:title,body:_templates.default.render("mod_competvet/view/eval_ask_observation_modal",{planningid:event.detail.planningid,studentid:event.detail.studentid,observers:event.detail.observers,context:event.detail.context,modulename:modulename}),type:_modal_factory.default.types.CANCEL,large:!0}).then((modal=>(modal.show(),modal))).catch(_notification.default.exception)}))}))};_exports.initUsersAction=(modulename,planningId,studentId,context)=>{const selectedElements=document.querySelectorAll(".ask-observation-modal [data-user-id]");selectedElements&&selectedElements.forEach((element=>{element.addEventListener("click",(event=>{event.preventDefault(),_ajax.default.call([{methodname:"mod_competvet_eval_ask_for_observation",args:{context:context,planningid:planningId,observerid:element.dataset.userId,studentid:studentId},done:data=>{data.todoid?element.classList.add("text-success"):(0,_str.get_string)("todo:cannotadd").then((message=>_notification.default.exception({message:message})))},fail:_notification.default.exception}])}))}))}}));

//# sourceMappingURL=eval_observation_ask.min.js.map