define("mod_competvet/local/manager/sortable",["exports","jquery","jqueryui","mod_competvet/local/competstate"],(function(_exports,_jquery,_jqueryui,_competstate){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Create a jquery sortable list.
   *
   * @module     mod_competvet/local/manager/sortable
   * @copyright  2024 Bas Brands <bas@sonsbeekmedia.nl>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_jquery=_interopRequireDefault(_jquery),_competstate=_interopRequireDefault(_competstate);var _default={sortable:selector=>{(0,_jquery.default)(selector).sortable({handle:".drag-handle",update:event=>{(async(type,gridId,criterionId,order)=>{let state=_competstate.default.getValue("datatree");"criterion"===type&&state.grids.forEach((grid=>{grid.gridid==gridId&&(grid.updatesortorder=!0,order.forEach(((criterionId,index)=>{grid.criteria.forEach((criterion=>{criterion.criterionid==criterionId&&(criterion.sortorder=index)})),grid.criteria.sort(((a,b)=>a.sortorder-b.sortorder))})))})),"option"===type&&state.grids.forEach((grid=>{grid.criteria.forEach((criterion=>{criterion.criterionid==criterionId&&(criterion.updatesortorder=!0,order.forEach(((optionId,index)=>{criterion.options.forEach((option=>{option.optionid==optionId&&(option.sortorder=index)}))})),criterion.options.sort(((a,b)=>a.sortorder-b.sortorder)))}))})),_competstate.default.setValue("datatree",state),document.dispatchEvent(new CustomEvent("saveState"))})((0,_jquery.default)(event.target).data("type"),(0,_jquery.default)(event.target).data("gridId"),(0,_jquery.default)(event.target).data("criterionId"),(0,_jquery.default)(event.target).sortable("toArray",{attribute:"data-id"}))}})}};return _exports.default=_default,_exports.default}));

//# sourceMappingURL=sortable.min.js.map