define("mod_competvet/local/grader_component",["exports","core/reactive","mod_competvet/local/grading_app_reactive","core/templates"],(function(_exports,_reactive,_grading_app_reactive,_templates){var obj;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_templates=(obj=_templates)&&obj.__esModule?obj:{default:obj};var _systemImportTransformerGlobalIdentifier="undefined"!=typeof window?window:"undefined"!=typeof self?self:"undefined"!=typeof global?global:{};class _default extends _reactive.BaseComponent{create(){this.name="grader-component",this.selectors={SUBMIT_BUTTON:"button[data-action='submit-grade']",GRADER_CONTENT:"[data-region='grader-content']"},this.cmId=this.getElement().dataset.cmid,this.itemName=this.getElement().dataset.itemName}static init(element,selectors){const cmId=element.dataset.cmid;return new this({element:element,reactive:(0,_grading_app_reactive.getGradingAppReactive)(cmId),selectors:selectors})}async stateReady(){const target=this.getElement();view(target,this.selectors.GRADER_CONTENT);const submitButton=this.getElement(this.SUBMIT_BUTTON);this.addEventListener(submitButton,"click",this._submitGrade)}getWatchers(){return[]}async _submitGrade(){const data=this.getElement().dataset,gradingPanelFunctions=await getGradingPanelFunctions("mod_competvet",data.contextid,data.gradingComponent,data.gradingComponentSubtype,data.itemName);await gradingPanelFunctions.setter(data.userid,!1,this.getElement(this.selectors.GRADER_CONTENT))}}_exports.default=_default;const getGradingPanelFunctions=async(component,context,gradingComponent,gradingSubtype,itemName)=>{let gradingMethodHandler="".concat(gradingComponent,"/grades/grader/gradingpanel");gradingSubtype&&(gradingMethodHandler+="/".concat(gradingSubtype));const GradingMethod=await("function"==typeof _systemImportTransformerGlobalIdentifier.define&&_systemImportTransformerGlobalIdentifier.define.amd?new Promise((function(resolve,reject){_systemImportTransformerGlobalIdentifier.require([gradingMethodHandler],resolve,reject)})):"undefined"!=typeof module&&module.exports&&"undefined"!=typeof require||"undefined"!=typeof module&&module.component&&_systemImportTransformerGlobalIdentifier.require&&"component"===_systemImportTransformerGlobalIdentifier.require.loader?Promise.resolve(require(gradingMethodHandler)):Promise.resolve(_systemImportTransformerGlobalIdentifier[gradingMethodHandler]));return{getter:userId=>GradingMethod.fetchCurrentGrade(component,context,itemName,userId),setter:(userId,notifyStudent,formData)=>GradingMethod.storeCurrentGrade(component,context,itemName,userId,notifyStudent,formData)}},view=async(rootNode,selector)=>{const data=rootNode.dataset,gradingPanelFunctions=await getGradingPanelFunctions("mod_competvet",data.contextid,data.gradingComponent,data.gradingComponentSubtype,data.itemName),userGrade=await gradingPanelFunctions.getter(data.userid),{html:gradeHTML,js:gradeJS}=await _templates.default.renderForPromise(userGrade.templatename,userGrade.grade),graderContentElement=rootNode.querySelector(selector);_templates.default.replaceNodeContents(graderContentElement,gradeHTML,gradeJS)};return _exports.default}));

//# sourceMappingURL=grader_component.min.js.map